---
title: "Assignment 3 (Storytelling wirh Open Data)"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    social: menu
    source_code: embed
runtime: shiny
---

```{r setup, include=FALSE}
# List of libraries
library(shiny)
library(ggplot2)
library(GGally)
library(tidyverse)
```

Sidebar {.sidebar}
=======================================================================

### Analysis for "Video Games Sales Dataset"

Student Name: Rakyan Adhikara

Student ID: s3935019

GitHub Page: [Here](https://github.com/radhikara-rmit/videogamessales_analysis)


```{r}
# Importing dataset
data <- read.csv("Video_Games_Sales_as_at_22_Dec_2016.csv")

# data pre-processing
data <- data %>% filter(Year_of_Release >= 2012)
data <- data %>% mutate(User_Popularity = if_else(User_Count >= 1000, "Popular", "Not Popular"))
data <- na.omit(data)
data$User_Score <- as.numeric(data$User_Score)
data$Year_of_Release <- as.numeric(data$Year_of_Release)
```

Explanation
=======================================================================

### Introduction

Video games are now such a commodity that people of all ages to enjoy. However, the market nowadays is relatively unchartered compared to other market. As such, some analyses for the global sales, the critic scores and the User Scores would have many real-world uses. Example, small indie video game companies will know what are their best video game genres or platforms to create by using this predictive model. More importantly, we as customers can figure out if the global sales, the critic scores and the User Score can be a great objective opinions of the games that we would like to buy in the future.

Thus, the main objective of this dashboard are analysis on Global Sales, User Scores, Critic Scores.

At this point, we make the important assumption that rows in our dataset are not correlated. That is, we assume that the global sales number observations are independent of one another in this dataset. 

### Dataset Features

Here are list of dataset features, the units and descriptions of each features:

  1. `Name` (**NA**): Name of the video game
  2. `Platform` (**NA**): Platform of the video game
  3. `Year_of_Release` (**yyyy**): Year of release of the video game
  4. `Genre` (**NA**): Genre of video game
  5. `Publisher` (**NA**): Publisher of video game
  6. `NA_Sales` (**USD, in millions**): Sales number of video game in North America
  7. `EU_Sales` (**USD, in millions**): Sales number of video game in Europe
  8. `JP_Sales` (**USD, in millions**): Sales number of video game in Japan
  9. `Other_Sales` (**USD, in millions**): Sales number of video game in other regions
  10. `Global_Sales` (**USD, in millions**): Sales number of video game globally
  11. `Critic_Score` (**NA**): Aggregate score compiled by Metacritic staff
  12. `Critic_Count` (**NA**): The number of critics
  13. `User_Score` (**NA**): Score by Metacritic's subscribers
  14. `User_Count` (**NA**): Number of users
  15. `Developer` (**NA**): Developer of the game
  16. `Rating` (**NA**): The ESRB ratings

Main analysis
=======================================================================

Row
-----------------------------------------------------------------------

### Downloads per sec (last 5 min)

```{r}
# downloadRate is a reactive expression that computes the download
# rate during this dashboard's lifetime.
# startTime <- as.numeric(Sys.time())
# downloadRate <- reactive({
#   elapsed <- as.numeric(Sys.time()) - startTime
#   nrow(pkgData()) / min(maxAgeSecs, elapsed)
# })
# 
# # Emit the download rate
# renderValueBox({
#   rate <- formatC(downloadRate(), digits = 1, format = "f")
#   valueBox(
#     value = rate,
#     icon = "fa-area-chart",
#     color = if (rate >= input$rateThreshold) "warning" else "primary"
#   )
# })
```

### Total downloads

```{r}
# dlCount is a reactive expression that keeps track of the total
# number of rows that have ever appeared through pkgStream.
# dlCount <- downloadCount(pkgStream)
# 
# # Emit the download count
# renderValueBox({
#   valueBox(dlCount(), icon = "fa-download")
# })
```

### Unique users

```{r}
# usrCount is a reactive expression that keeps an approximate
# count of all of the unique users that have been seen since the
# app started.
# usrCount <- userCount(pkgStream)
# 
# # Emit the user count
# renderValueBox({
#   valueBox(value = usrCount(), icon = "fa-users")
# })
```

Row
-----------------------------------------------------------------------

### Downloads per sec (last 5 min)

```{r}
# renderGauge({
#   rate <- formatC(downloadRate(), digits = 1, format = "f")
#   gauge(rate, min = 0, max = 10, gaugeSectors(
#     success = c(0, input$rateThreshold - 1), 
#     warning = c(input$rateThreshold - 1, input$rateThreshold), 
#     danger = c(input$rateThreshold - 1, 10)
#   ))
# })
```

### Average downloads per user

```{r}
# renderGauge({
#   per <- formatC(dlCount() / usrCount(), digits = 1, format = "f")
#   gauge(per, min = 0, max = 5, gaugeSectors(
#     success = c(0, 3), 
#     warning = c(3, 4), 
#     danger = c(4, 5)
#   ))
# })
```

### Downloads per sec (last 5 min)

```{r}
# pkgTable <- reactive({
#   pkgData() %>%
#     group_by(package) %>%
#     tally() %>%
#     arrange(desc(n), tolower(package)) %>%
#     mutate(percentage = n / nrow(pkgData()) * 100) %>%
#     select("Package" = package, "Percent" = percentage) %>%
#     as.data.frame() %>%
#     head(30)
# })
# 
# 
# renderGauge({
#   pct <- formatC(pkgTable()[1, 2], digits = 1, format = "f")
#   gauge(pct, min = 0, max = 10, symbol = '%', gaugeSectors(
#     success = c(0, 8), 
#     warning = c(8, 9), 
#     danger = c(9, 10)
#   ))
# })
```


Row
-----------------------------------------------------------------------

### Popularity by package (last 5 min) {data-width=700}

```{r}
# renderBubbles({
#   if (nrow(pkgData()) == 0)
#     return()
# 
#   order <- unique(pkgData()$package)
#   df <- pkgData() %>%
#     group_by(package) %>%
#     tally() %>%
#     arrange(desc(n), tolower(package)) %>%
#     # Just show the top 60, otherwise it gets hard to see
#     head(60)
# 
#   bubbles(df$n, df$package, key = df$package)
# })
```

### Percent of downloads (last 5 min) {data-width=340}

```{r}
# renderTable({
#   pkgTable()
# }, digits = 1)

```

Details
=======================================================================

### Recent Downlads

```{r}
ui <- fluidPage(
  titlePanel("censusVis"),
  
  sidebarLayout(
    sidebarPanel(
      helpText("Create demographic maps with 
               information from the 2010 US Census."),
      
      selectInput("var", 
                  label = "Choose a variable to display",
                  choices = c("Percent White", 
                              "Percent Black",
                              "Percent Hispanic", 
                              "Percent Asian"),
                  selected = "Percent White"),
      
      sliderInput("range", 
                  label = "Range of interest:",
                  min = 0, max = 100, value = c(0, 100))
    ),
    
    mainPanel(
      textOutput("selected_var"),
      textOutput("min_max")
    )
  )
)

server <- function(input, output) {
  
  output$selected_var <- renderText({ 
    paste("You have selected", input$var)
  })
  
  output$min_max <- renderText({ 
    paste("You have chosen a range that goes from",
          input$range[1], "to", input$range[2])
  })
  
}

shinyApp(ui, server)
```
